<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #taskInput, #timeInput, #dayInput {
            width: 200px;
            margin-right: 10px;
        }
        #addTaskBtn {
            cursor: pointer;
        }
        #calendar {
            margin-top: 20px;
            border-collapse: collapse;
        }
        #calendar th, #calendar td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
    </style>
</head>
<body>
    <h1>Task Manager</h1>
    <input type="text" id="taskInput" placeholder="Enter task">
    <input type="time" id="timeInput">
    <input type="date" id="dayInput">
    <button id="addTaskBtn">Add Task</button>
    <ul id="taskList"></ul>

    <h2 id="monthYear">Calendar</h2>
    <table id="calendar">
        <thead>
            <tr>
                <th>Sun</th>
                <th>Mon</th>
                <th>Tue</th>
                <th>Wed</th>
                <th>Thu</th>
                <th>Fri</th>
                <th>Sat</th>
            </tr>
        </thead>
        <tbody id="calendarBody"></tbody>
    </table>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const taskInput = document.getElementById("taskInput");
            const timeInput = document.getElementById("timeInput");
            const dayInput = document.getElementById("dayInput");
            const addTaskBtn = document.getElementById("addTaskBtn");
            const taskList = document.getElementById("taskList");
            const calendarBody = document.getElementById("calendarBody");
            const monthYearHeader = document.getElementById("monthYear");

            addTaskBtn.addEventListener("click", function () {
                const taskText = taskInput.value.trim();
                const taskTime = timeInput.value;
                const taskDay = dayInput.value;

                if (taskText !== "") {
                    const taskItem = document.createElement("li");
                    taskItem.textContent = `${taskText} - Time: ${taskTime}, Day: ${taskDay}`;
                    taskList.appendChild(taskItem);

                    // Update the calendar
                    updateCalendar(taskText, taskTime, taskDay);
                    
                    // Clear input fields
                    taskInput.value = "";
                    timeInput.value = "";
                    dayInput.value = "";
                }
            });

            function updateCalendar(taskText, taskTime, taskDay) {
                const date = new Date(taskDay);
                const dayOfMonth = date.getDate();
                const dayOfWeek = date.getDay();
                const calendarCell = document.querySelector(`#calendarBody td:nth-child(${dayOfMonth + dayOfWeek})`);

                const dayDiv = document.createElement("div");
                dayDiv.className = "day";
                dayDiv.textContent = dayOfMonth;

                const taskDiv = document.createElement("div");
                taskDiv.className = "tasks";

                const taskItem = document.createElement("div");
                taskItem.className = "task";
                taskItem.textContent = `${taskText} - Time: ${taskTime}`;

                const actionsDiv = document.createElement("div");
                actionsDiv.className = "actions";

                const actionsDropdown = document.createElement("select");

                const editOption = document.createElement("option");
                editOption.value = "edit";
                editOption.textContent = "Edit";
                actionsDropdown.appendChild(editOption);

                const deleteOption = document.createElement("option");
                deleteOption.value = "delete";
                deleteOption.textContent = "Delete";
                actionsDropdown.appendChild(deleteOption);

                actionsDropdown.addEventListener("change", function () {
                    handleAction(this.value, taskItem);
                    this.selectedIndex = 0; // Reset the dropdown to the default option
                });

                actionsDiv.appendChild(actionsDropdown);
                taskItem.appendChild(actionsDiv);

                taskDiv.appendChild(dayDiv);
                taskDiv.appendChild(taskItem);

                calendarCell.appendChild(taskDiv);
            }

            function handleAction(action, taskItem) {
                switch (action) {
                    case "edit":
                        editTask(taskItem);
                        break;
                    case "delete":
                        deleteTask(taskItem);
                        break;
                    default:
                        break;
                }
            }

            function editTask(taskItem) {
                const newText = prompt("Edit task:", taskItem.textContent);
                if (newText !== null) {
                    taskItem.textContent = newText;
                }
            }

            function deleteTask(taskItem) {
                if (confirm("Are you sure you want to delete this task?")) {
                    taskItem.parentNode.removeChild(taskItem);
                }
            }


            function generateCalendar() {
                const calendarBody = document.querySelector("#calendarBody");

                // Clear previous calendar
                while (calendarBody.firstChild) {
                    calendarBody.removeChild(calendarBody.firstChild);
                }

                const date = new Date();
                const firstDayOfMonth = new Date(date.getFullYear(), date.getMonth(), 1);
                const daysInMonth = new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();
                
                // Set the month and year in the header
                const monthYearText = new Intl.DateTimeFormat('en-US', { month: 'long', year: 'numeric' }).format(firstDayOfMonth);
                monthYearHeader.textContent = `Calendar - ${monthYearText}`;

                // Populate calendar days
                let currentDay = 1;
                for (let week = 0; week < 6; week++) {
                    const tr = document.createElement("tr");
                    calendarBody.appendChild(tr);

                    for (let day = 0; day < 7; day++) {
                        const td = document.createElement("td");
                        if (week === 0 && day < firstDayOfMonth.getDay()) {
                            // Empty cell before the first day of the month
                            td.textContent = '';
                        } else if (currentDay <= daysInMonth) {
                            // Populate the actual days of the month
                            td.textContent = currentDay;
                            currentDay++;
                        }
                        tr.appendChild(td);
                    }
                }
            }

            generateCalendar();
        });
    </script>
</body>
</html>
